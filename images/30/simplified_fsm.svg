<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: varnishfsm Pages: 1 -->
<svg width="685pt" height="957pt"
 viewBox="0.00 0.00 685.00 957.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 953)">
<title>varnishfsm</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-953 681,-953 681,4 -4,4"/>
<g id="clust1" class="cluster"><title>clusterfrontend</title>
<polygon fill="none" stroke="black" points="8,-8 8,-886 669,-886 669,-8 8,-8"/>
<text text-anchor="middle" x="115" y="-870.8" font-family="Times,serif" font-size="14.00">Frontend (From Client) Workthread</text>
</g>
<g id="clust4" class="cluster"><title>clusterbackend</title>
<polygon fill="aliceblue" stroke="black" points="62,-164 62,-545 430,-545 430,-164 62,-164"/>
<text text-anchor="middle" x="162" y="-529.8" font-family="Times,serif" font-size="14.00">Backend (To Server) Workthread</text>
</g>
<!-- Request -->
<g id="node1" class="node"><title>Request</title>
<polygon fill="none" stroke="black" points="275,-949 219.701,-931 275,-913 330.299,-931 275,-949"/>
<polyline fill="none" stroke="black" points="231.111,-934.714 231.111,-927.286 "/>
<polyline fill="none" stroke="black" points="263.589,-916.714 286.411,-916.714 "/>
<polyline fill="none" stroke="black" points="318.889,-927.286 318.889,-934.714 "/>
<polyline fill="none" stroke="black" points="286.411,-945.286 263.589,-945.286 "/>
<text text-anchor="middle" x="275" y="-927.3" font-family="Times,serif" font-size="14.00">Request</text>
</g>
<!-- vcl_recv -->
<g id="node3" class="node"><title>vcl_recv</title>
<ellipse fill="none" stroke="black" cx="337" cy="-837" rx="40.8928" ry="18"/>
<text text-anchor="middle" x="337" y="-833.3" font-family="Times,serif" font-size="14.00">vcl_recv</text>
</g>
<!-- Request&#45;&gt;vcl_recv -->
<g id="edge1" class="edge"><title>Request&#45;&gt;vcl_recv</title>
<path fill="none" stroke="black" d="M284.416,-916.027C293.878,-901.987 308.666,-880.044 320.152,-863"/>
<polygon fill="black" stroke="black" points="323.127,-864.849 325.813,-854.601 317.322,-860.937 323.127,-864.849"/>
</g>
<!-- restart1 -->
<g id="node2" class="node"><title>restart1</title>
<polygon fill="none" stroke="black" points="399,-949 348.393,-931 399,-913 449.607,-931 399,-949"/>
<polyline fill="none" stroke="black" points="359.699,-935.021 359.699,-926.979 "/>
<polyline fill="none" stroke="black" points="387.694,-917.021 410.306,-917.021 "/>
<polyline fill="none" stroke="black" points="438.301,-926.979 438.301,-935.021 "/>
<polyline fill="none" stroke="black" points="410.306,-944.979 387.694,-944.979 "/>
<text text-anchor="middle" x="399" y="-927.3" font-family="Times,serif" font-size="14.00">Restart</text>
</g>
<!-- restart1&#45;&gt;vcl_recv -->
<g id="edge2" class="edge"><title>restart1&#45;&gt;vcl_recv</title>
<path fill="none" stroke="black" d="M389.584,-916.027C380.122,-901.987 365.334,-880.044 353.848,-863"/>
<polygon fill="black" stroke="black" points="356.678,-860.937 348.187,-854.601 350.873,-864.849 356.678,-860.937"/>
</g>
<!-- vcl_hash -->
<g id="node9" class="node"><title>vcl_hash</title>
<ellipse fill="none" stroke="black" cx="337" cy="-750" rx="42.4939" ry="18"/>
<text text-anchor="middle" x="337" y="-746.3" font-family="Times,serif" font-size="14.00">vcl_hash</text>
</g>
<!-- vcl_recv&#45;&gt;vcl_hash -->
<g id="edge3" class="edge"><title>vcl_recv&#45;&gt;vcl_hash</title>
<path fill="none" stroke="black" d="M337,-818.799C337,-807.163 337,-791.548 337,-778.237"/>
<polygon fill="black" stroke="black" points="340.5,-778.175 337,-768.175 333.5,-778.175 340.5,-778.175"/>
<text text-anchor="middle" x="356" y="-789.8" font-family="Times,serif" font-size="14.00">lookup</text>
</g>
<!-- vcl_deliver -->
<g id="node4" class="node"><title>vcl_deliver</title>
<ellipse fill="none" stroke="black" cx="150" cy="-117" rx="50.0912" ry="18"/>
<text text-anchor="middle" x="150" y="-113.3" font-family="Times,serif" font-size="14.00">vcl_deliver</text>
</g>
<!-- Done -->
<g id="node12" class="node"><title>Done</title>
<polygon fill="none" stroke="black" points="464,-62 418,-62 418,-16 464,-16 464,-62"/>
<polyline fill="none" stroke="black" points="430,-62 418,-50 "/>
<polyline fill="none" stroke="black" points="418,-28 430,-16 "/>
<polyline fill="none" stroke="black" points="452,-16 464,-28 "/>
<polyline fill="none" stroke="black" points="464,-50 452,-62 "/>
<text text-anchor="middle" x="441" y="-35.3" font-family="Times,serif" font-size="14.00">Done</text>
</g>
<!-- vcl_deliver&#45;&gt;Done -->
<g id="edge27" class="edge"><title>vcl_deliver&#45;&gt;Done</title>
<path fill="none" stroke="black" d="M189.246,-105.75C247.106,-90.6389 354.259,-62.6541 408.188,-48.5695"/>
<polygon fill="black" stroke="black" points="409.133,-51.94 417.924,-46.0266 407.364,-45.1672 409.133,-51.94"/>
</g>
<!-- vcl_synth -->
<g id="node5" class="node"><title>vcl_synth</title>
<ellipse fill="none" stroke="black" cx="441" cy="-117" rx="44.6926" ry="18"/>
<text text-anchor="middle" x="441" y="-113.3" font-family="Times,serif" font-size="14.00">vcl_synth</text>
</g>
<!-- vcl_synth&#45;&gt;Done -->
<g id="edge28" class="edge"><title>vcl_synth&#45;&gt;Done</title>
<path fill="none" stroke="black" d="M441,-98.7544C441,-90.8631 441,-81.2491 441,-72.1025"/>
<polygon fill="black" stroke="black" points="444.5,-72.0908 441,-62.0908 437.5,-72.0909 444.5,-72.0908"/>
</g>
<!-- vcl_hit -->
<g id="node6" class="node"><title>vcl_hit</title>
<ellipse fill="none" stroke="black" cx="51" cy="-663" rx="35.194" ry="18"/>
<text text-anchor="middle" x="51" y="-659.3" font-family="Times,serif" font-size="14.00">vcl_hit</text>
</g>
<!-- vcl_hit&#45;&gt;vcl_deliver -->
<g id="edge13" class="edge"><title>vcl_hit&#45;&gt;vcl_deliver</title>
<path fill="none" stroke="darkgreen" d="M51,-644.784C51,-630.405 51,-609.366 51,-591 51,-591 51,-591 51,-189 51,-177.462 50.6546,-172.898 58,-164 69.5936,-149.955 86.5507,-139.8 102.758,-132.665"/>
<polygon fill="darkgreen" stroke="darkgreen" points="104.244,-135.839 112.168,-128.806 101.588,-129.362 104.244,-135.839"/>
</g>
<!-- vcl_pass -->
<g id="node11" class="node"><title>vcl_pass</title>
<ellipse fill="none" stroke="black" cx="182" cy="-590" rx="40.8928" ry="18"/>
<text text-anchor="middle" x="182" y="-586.3" font-family="Times,serif" font-size="14.00">vcl_pass</text>
</g>
<!-- vcl_hit&#45;&gt;vcl_pass -->
<g id="edge14" class="edge"><title>vcl_hit&#45;&gt;vcl_pass</title>
<path fill="none" stroke="red" d="M74.197,-649.307C86.8412,-642.399 102.771,-633.712 117,-626 127.094,-620.53 138.082,-614.602 148.104,-609.207"/>
<polygon fill="red" stroke="red" points="149.833,-612.251 156.981,-604.431 146.517,-606.087 149.833,-612.251"/>
</g>
<!-- vcl_miss -->
<g id="node7" class="node"><title>vcl_miss</title>
<ellipse fill="none" stroke="black" cx="305" cy="-663" rx="42.4939" ry="18"/>
<text text-anchor="middle" x="305" y="-659.3" font-family="Times,serif" font-size="14.00">vcl_miss</text>
</g>
<!-- vcl_miss&#45;&gt;vcl_pass -->
<g id="edge18" class="edge"><title>vcl_miss&#45;&gt;vcl_pass</title>
<path fill="none" stroke="red" d="M280.992,-648.142C262.113,-637.244 235.612,-621.947 214.78,-609.922"/>
<polygon fill="red" stroke="red" points="216.358,-606.791 205.947,-604.823 212.858,-612.854 216.358,-606.791"/>
</g>
<!-- vcl_backend_fetch -->
<g id="node14" class="node"><title>vcl_backend_fetch</title>
<ellipse fill="none" stroke="black" cx="243" cy="-496" rx="77.1866" ry="18"/>
<text text-anchor="middle" x="243" y="-492.3" font-family="Times,serif" font-size="14.00">vcl_backend_fetch</text>
</g>
<!-- vcl_miss&#45;&gt;vcl_backend_fetch -->
<g id="edge15" class="edge"><title>vcl_miss&#45;&gt;vcl_backend_fetch</title>
<path fill="none" stroke="blue" d="M298.598,-644.964C287.785,-616.186 265.828,-557.751 252.979,-523.557"/>
<polygon fill="blue" stroke="blue" points="256.253,-522.321 249.46,-514.191 249.701,-524.783 256.253,-522.321"/>
</g>
<!-- vcl_purge -->
<g id="node8" class="node"><title>vcl_purge</title>
<ellipse fill="none" stroke="black" cx="411" cy="-663" rx="46.2923" ry="18"/>
<text text-anchor="middle" x="411" y="-659.3" font-family="Times,serif" font-size="14.00">vcl_purge</text>
</g>
<!-- vcl_purge&#45;&gt;vcl_synth -->
<g id="edge12" class="edge"><title>vcl_purge&#45;&gt;vcl_synth</title>
<path fill="none" stroke="purple" d="M422.513,-645.327C430.973,-631.44 441,-610.805 441,-591 441,-591 441,-591 441,-189 441,-174.651 441,-158.671 441,-145.511"/>
<polygon fill="purple" stroke="purple" points="444.5,-145.216 441,-135.216 437.5,-145.216 444.5,-145.216"/>
</g>
<!-- vcl_hash&#45;&gt;vcl_hit -->
<g id="edge7" class="edge"><title>vcl_hash&#45;&gt;vcl_hit</title>
<path fill="none" stroke="darkgreen" d="M295.466,-745.909C237.345,-741.063 135.145,-730.491 102,-714 89.6844,-707.873 78.4653,-697.666 69.7052,-688.067"/>
<polygon fill="darkgreen" stroke="darkgreen" points="72.1395,-685.53 62.9549,-680.249 66.8411,-690.105 72.1395,-685.53"/>
<text text-anchor="middle" x="109.5" y="-702.8" font-family="Times,serif" font-size="14.00">hit</text>
</g>
<!-- vcl_hash&#45;&gt;vcl_miss -->
<g id="edge8" class="edge"><title>vcl_hash&#45;&gt;vcl_miss</title>
<path fill="none" stroke="blue" d="M330.524,-731.799C326.071,-719.97 320.07,-704.03 315.006,-690.578"/>
<polygon fill="blue" stroke="blue" points="318.156,-689.011 311.357,-680.885 311.605,-691.477 318.156,-689.011"/>
<text text-anchor="middle" x="336" y="-702.8" font-family="Times,serif" font-size="14.00">miss</text>
</g>
<!-- vcl_hash&#45;&gt;vcl_purge -->
<g id="edge11" class="edge"><title>vcl_hash&#45;&gt;vcl_purge</title>
<path fill="none" stroke="purple" d="M351.268,-732.611C362.222,-720.029 377.516,-702.462 389.885,-688.253"/>
<polygon fill="purple" stroke="purple" points="392.849,-690.179 396.776,-680.339 387.57,-685.583 392.849,-690.179"/>
<text text-anchor="middle" x="394.5" y="-702.8" font-family="Times,serif" font-size="14.00">purge</text>
</g>
<!-- vcl_pipe -->
<g id="node10" class="node"><title>vcl_pipe</title>
<ellipse fill="none" stroke="black" cx="516" cy="-663" rx="40.8928" ry="18"/>
<text text-anchor="middle" x="516" y="-659.3" font-family="Times,serif" font-size="14.00">vcl_pipe</text>
</g>
<!-- vcl_hash&#45;&gt;vcl_pipe -->
<g id="edge4" class="edge"><title>vcl_hash&#45;&gt;vcl_pipe</title>
<path fill="none" stroke="orange" d="M365.251,-736.396C379.853,-729.821 397.934,-721.587 414,-714 436.375,-703.434 461.319,-691.214 480.939,-681.5"/>
<polygon fill="orange" stroke="orange" points="482.706,-684.531 490.108,-676.951 479.594,-678.26 482.706,-684.531"/>
<text text-anchor="middle" x="456" y="-702.8" font-family="Times,serif" font-size="14.00">pipe</text>
</g>
<!-- vcl_hash&#45;&gt;vcl_pass -->
<g id="edge5" class="edge"><title>vcl_hash&#45;&gt;vcl_pass</title>
<path fill="none" stroke="red" d="M296.202,-745.314C262.824,-741.091 215.085,-732.235 177,-714 155.902,-703.899 146.102,-702.098 136,-681 129.09,-666.569 130.472,-660.015 136,-645 140.278,-633.38 148.292,-622.557 156.447,-613.699"/>
<polygon fill="red" stroke="red" points="159.055,-616.038 163.559,-606.449 154.058,-611.136 159.055,-616.038"/>
<text text-anchor="middle" x="148" y="-659.3" font-family="Times,serif" font-size="14.00">pass</text>
</g>
<!-- vcl_hash&#45;&gt;vcl_pass -->
<g id="edge9" class="edge"><title>vcl_hash&#45;&gt;vcl_pass</title>
<path fill="none" stroke="red" d="M298.8,-742.182C264.629,-733.928 216.168,-716.456 191,-681 178.116,-662.849 176.741,-637.205 178.079,-617.931"/>
<polygon fill="red" stroke="red" points="181.564,-618.258 179.046,-607.967 174.596,-617.582 181.564,-618.258"/>
<text text-anchor="middle" x="222.5" y="-659.3" font-family="Times,serif" font-size="14.00">hit&#45;for&#45;pass</text>
</g>
<!-- waiting -->
<g id="node13" class="node"><title>waiting</title>
<polygon fill="none" stroke="black" points="660.557,-663 639.278,-681 596.722,-681 575.443,-663 596.722,-645 639.278,-645 660.557,-663"/>
<text text-anchor="middle" x="618" y="-659.3" font-family="Times,serif" font-size="14.00">waiting</text>
</g>
<!-- vcl_hash&#45;&gt;waiting -->
<g id="edge10" class="edge"><title>vcl_hash&#45;&gt;waiting</title>
<path fill="none" stroke="black" d="M373.021,-740.454C400.335,-733.783 438.724,-723.996 472,-714 508.886,-702.92 550.382,-688.518 579.681,-678.018"/>
<polygon fill="black" stroke="black" points="580.902,-681.299 589.125,-674.618 578.531,-674.713 580.902,-681.299"/>
<text text-anchor="middle" x="529" y="-702.8" font-family="Times,serif" font-size="14.00">busy</text>
</g>
<!-- vcl_pipe&#45;&gt;Done -->
<g id="edge6" class="edge"><title>vcl_pipe&#45;&gt;Done</title>
<path fill="none" stroke="orange" d="M513.732,-644.818C512.033,-630.46 510,-609.432 510,-591 510,-591 510,-591 510,-116 510,-92.1085 491.077,-72.3977 473.051,-59.0409"/>
<polygon fill="orange" stroke="orange" points="474.57,-55.8346 464.36,-53.0038 470.576,-61.5836 474.57,-55.8346"/>
</g>
<!-- vcl_pass&#45;&gt;vcl_backend_fetch -->
<g id="edge17" class="edge"><title>vcl_pass&#45;&gt;vcl_backend_fetch</title>
<path fill="none" stroke="red" d="M192.906,-572.552C202.158,-558.597 215.583,-538.35 226.207,-522.328"/>
<polygon fill="red" stroke="red" points="229.167,-524.196 231.776,-513.928 223.333,-520.328 229.167,-524.196"/>
</g>
<!-- waiting&#45;&gt;vcl_hash -->
<g id="edge16" class="edge"><title>waiting&#45;&gt;vcl_hash</title>
<path fill="none" stroke="black" d="M598.609,-681.031C584.855,-692.173 565.453,-706.084 546,-714 495.051,-734.732 432.324,-743.186 388.956,-746.632"/>
<polygon fill="black" stroke="black" points="388.632,-743.146 378.915,-747.368 389.144,-750.128 388.632,-743.146"/>
</g>
<!-- decision1 -->
<g id="node15" class="node"><title>decision1</title>
<polygon fill="none" stroke="black" points="243,-441 124.357,-423 243,-405 361.643,-423 243,-441"/>
<text text-anchor="middle" x="243" y="-419.3" font-family="Times,serif" font-size="14.00">read beresp(headers)</text>
</g>
<!-- vcl_backend_fetch&#45;&gt;decision1 -->
<g id="edge19" class="edge"><title>vcl_backend_fetch&#45;&gt;decision1</title>
<path fill="none" stroke="black" d="M243,-477.813C243,-469.789 243,-460.047 243,-451.069"/>
<polygon fill="black" stroke="black" points="246.5,-451.029 243,-441.029 239.5,-451.029 246.5,-451.029"/>
</g>
<!-- vcl_backend_response -->
<g id="node16" class="node"><title>vcl_backend_response</title>
<ellipse fill="none" stroke="black" cx="160" cy="-350" rx="90.1842" ry="18"/>
<text text-anchor="middle" x="160" y="-346.3" font-family="Times,serif" font-size="14.00">vcl_backend_response</text>
</g>
<!-- decision1&#45;&gt;vcl_backend_response -->
<g id="edge20" class="edge"><title>decision1&#45;&gt;vcl_backend_response</title>
<path fill="none" stroke="black" d="M225.802,-407.289C214.635,-397.736 199.843,-385.082 187.112,-374.192"/>
<polygon fill="black" stroke="black" points="189.377,-371.524 179.502,-367.683 184.826,-376.843 189.377,-371.524"/>
</g>
<!-- vcl_backend_error -->
<g id="node17" class="node"><title>vcl_backend_error</title>
<ellipse fill="none" stroke="black" cx="345" cy="-350" rx="76.8869" ry="18"/>
<text text-anchor="middle" x="345" y="-346.3" font-family="Times,serif" font-size="14.00">vcl_backend_error</text>
</g>
<!-- decision1&#45;&gt;vcl_backend_error -->
<g id="edge21" class="edge"><title>decision1&#45;&gt;vcl_backend_error</title>
<path fill="none" stroke="black" d="M263.152,-407.973C277.49,-397.993 297.038,-384.386 313.434,-372.972"/>
<polygon fill="black" stroke="black" points="315.469,-375.82 321.677,-367.235 311.47,-370.075 315.469,-375.82"/>
</g>
<!-- decision4 -->
<g id="node18" class="node"><title>decision4</title>
<polygon fill="none" stroke="black" points="160,-295 90.2878,-277 160,-259 229.712,-277 160,-295"/>
<text text-anchor="middle" x="160" y="-273.3" font-family="Times,serif" font-size="14.00">cacheable?</text>
</g>
<!-- vcl_backend_response&#45;&gt;decision4 -->
<g id="edge22" class="edge"><title>vcl_backend_response&#45;&gt;decision4</title>
<path fill="none" stroke="black" d="M160,-331.813C160,-323.789 160,-314.047 160,-305.069"/>
<polygon fill="black" stroke="black" points="163.5,-305.029 160,-295.029 156.5,-305.029 163.5,-305.029"/>
</g>
<!-- cache -->
<g id="node19" class="node"><title>cache</title>
<polygon fill="none" stroke="black" points="143,-208 89,-208 89,-172 143,-172 143,-208"/>
<text text-anchor="middle" x="116" y="-186.3" font-family="Times,serif" font-size="14.00">cache</text>
</g>
<!-- decision4&#45;&gt;cache -->
<g id="edge23" class="edge"><title>decision4&#45;&gt;cache</title>
<path fill="none" stroke="green" d="M152.134,-260.804C145.848,-248.661 136.892,-231.36 129.47,-217.021"/>
<polygon fill="green" stroke="green" points="132.562,-215.382 124.857,-208.11 126.346,-218.6 132.562,-215.382"/>
<text text-anchor="middle" x="150.5" y="-229.8" font-family="Times,serif" font-size="14.00">yes</text>
</g>
<!-- nocache -->
<g id="node20" class="node"><title>nocache</title>
<polygon fill="none" stroke="black" points="247,-208 161,-208 161,-172 247,-172 247,-208"/>
<text text-anchor="middle" x="204" y="-186.3" font-family="Times,serif" font-size="14.00">do not cache</text>
</g>
<!-- decision4&#45;&gt;nocache -->
<g id="edge24" class="edge"><title>decision4&#45;&gt;nocache</title>
<path fill="none" stroke="red" d="M167.866,-260.804C174.152,-248.661 183.108,-231.36 190.53,-217.021"/>
<polygon fill="red" stroke="red" points="193.654,-218.6 195.143,-208.11 187.438,-215.382 193.654,-218.6"/>
<text text-anchor="middle" x="216.5" y="-229.8" font-family="Times,serif" font-size="14.00">hit&#45;for&#45;pass</text>
</g>
<!-- cache&#45;&gt;vcl_deliver -->
<g id="edge25" class="edge"><title>cache&#45;&gt;vcl_deliver</title>
<path fill="none" stroke="green" d="M124.23,-171.813C128.198,-163.528 133.043,-153.41 137.457,-144.193"/>
<polygon fill="green" stroke="green" points="140.683,-145.56 141.845,-135.029 134.37,-142.536 140.683,-145.56"/>
</g>
<!-- nocache&#45;&gt;vcl_deliver -->
<g id="edge26" class="edge"><title>nocache&#45;&gt;vcl_deliver</title>
<path fill="none" stroke="red" d="M190.928,-171.813C184.265,-163.052 176.043,-152.242 168.721,-142.615"/>
<polygon fill="red" stroke="red" points="171.419,-140.381 162.58,-134.54 165.848,-144.618 171.419,-140.381"/>
</g>
</g>
</svg>
