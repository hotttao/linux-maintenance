# 11.4 程序包编译安装
## 1. 程序包编译安装：
### 1.1 编译安装概述
rpm 源码包:
- 命名: testapp-VERSION-release.src.rpm
- 作用: 使用rpmbuild命令制作成二进制格式的rpm包，而后再安装；
- 安装过程: 源代码 --> 预处理 --> 编译(gcc) --> 汇编 --> 链接 --> 执行
- 源代码组织格式：多文件, 文件中的代码之间，很可能存在跨文件依赖关系

项目管理工具
- C、C++： make (configure --> Makefile.in --> makefile)
- java: maven


### 1.2 C代码编译安装三步骤：
1. ./configure：
    - 通过选项传递参数，指定启用特性、安装路径等；执行时会参考用户的指定以及Makefile.in文件生成makefile；
    - 检查依赖到的外部环境；
2. make：根据makefile文件，构建应用程序；
3. make install: 脚本，将构建的应用程序放置到配置的目录中
4. 建议：安装前查看INSTALL，README

开发工具：
- autoconf: 生成configure脚本
- automake：生成Makefile.in


### 1.3 开源程序源代码的获取：
1. 官方自建站点：
    - apache.org (ASF)
    - mariadb.org
2. 代码托管：
    - SourceForge
    - Github.com
    - code.google.com

## 2. 编译C源代码：
1. 前提：提供开发工具及开发环境
    - 开发工具：make, gcc等
    - 开发环境：开发库，头文件, glibc(C 标准库)
    - 通过“包组”提供开发组件
        - CentOS 6: "Development Tools", "Server Platform Development",
        - yum groupinstall "Development Tools"
2. 执行 configure脚本，指定安装位置、指定启用的特性
    - --help: 获取其支持使用的选项
    - 安装路径设定：
        - **--prefix=**/PATH/TO/SOMEWHERE: 指定默认安装位置；默认为/usr/local/
        - **--sysconfdir=**/PATH/TO/SOMEWHERE：配置文件安装位置；
    - System types: 指定目标平台系统结构
    - Optional Features: 可选特性
        - --disable-FEATURE: 关闭特性
        - --enable-FEATURE[=ARG]: 启用特性
    - Optional Packages: 可选包
        - --with-PACKAGE[=ARG]
        - --without-PACKAGE
3. 执行 make
4. make install
5. 安装后的配置：
    - 导出二进制程序目录至PATH环境变量中；
        - 编辑文件/etc/profile.d/NAME.sh，export PATH=/PATH/TO/BIN:$PATH
    - 导出库文件路径：
        - 编辑/etc/ld.so.conf.d/NAME.conf ，添加新的库文件所在目录至此文件中；
        - 让系统重新生成缓存：ldconfig [-v]
    - 导出头文件
        - 基于链接的方式实现：ln -sv /path/include  /usr/include/dir
    - 导出帮助手册
        - 编辑/etc/man.config文件，添加一个MANPATH
