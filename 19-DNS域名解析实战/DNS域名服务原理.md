# 19.1 DNS域名服务原理
DNS 虽然是互联网的基础服务，但是实际上会买域名，配置 DNS 服务器的人很少，所以很多人对 DNS 服务并不熟悉。本节我们就来讲解 DNS 服务的基本原理。

## 1. DNS 概述：
### 1.1 DNS 相关概念
DNS 全称为 Domain Name Service 属于应用层协议，工作于 udp/tcp 的 53 号端口。DNS 服务工作于 udp 53 号端口，tcp 的 53 端口用于实现主从 DNS 同步。

为了分散 DNS 查询的负载，同时方便域名的管理，DNS 被组织成一个倒置的树结构。如下图所示
![DNS](../images/19/dns_level.jpg)


- tld：Top Level Domain
	- 组织域：.com, .net, .org, .gov, .edu, .mil
	- 国家域：.iq, .tw, .hk, .jp, .cn, ...
- DNS查询类型：
	- 递归查询：
	- 迭代查询：
- DNS名称解析方式：
 	- 名称 --> IP：正向解析
	- IP --> 名称：反向解析
	- 注意：二者的名称空间，非为同一个空间，即非为同一棵树；因此，也不是同一个解析库；
- DNS服务器类型：
	- 负责解析至少一个域：
		- 主名称服务器；
		- 辅助名称服务器；
	- 不负责哉解析：
		- 缓存名称服务器；

### 1.2 DNS 查询请求
1. 一次完整的查询请求经过的流程：
	- Client --> hosts文件 --> DNS Local Cache --> DNS  Server (recursion) -->
	- 自己负责解析的域：直接查询数据库并返回答案；
	- 不是自己负责解析域：Server Cache --> iteration(迭代)
2. 解析答案：
	- 肯定答案：
	- 否定答案：不存在查询的键，因此，不存在与其查询键对应的值；
	- 权威答案：由直接负责的DNS服务器返回的答案；
	- 非权威答案：
